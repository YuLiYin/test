---
title: "HW01-Yuli-Yin"
author: Yuli Yin
date: 02/23/2018
output: html_document
---
#Q2 Data Import 

```{r}
column.names <- c(
    'symboling',
    'normalized_losses',
    'make',
    'fuel_type',
    'aspiration',
    'num_of_doors',
    'body_style',
    'drive_wheels',
    'engine_location',
    'wheel_base',
    'length',
    'width',
    'height',
    'curb_weight',
    'engine_type',
    'num_of_cylinders',
    'engine_size',
    'fuel_system',
    'bore',
    'stroke',
    'compression_ratio',
    'horsepower',
    'peak_rpm',
    'city_mpg',
    'highway_mpg',
    'price'
)
column.types <- c(
    'real',
    'real',
    'character',
    'character',
    'character',
    'character',
    'character',
    'character',
    'character',
    'real',
    'real',
    'real',
    'real',
    'integer',
    'character',
    'character',
    'integer',
    'character',
    'real',
    'real',
    'real',
    'integer',
    'integer',
    'integer',
    'integer',
    'integer'
)
imports.85 <- read.csv(
    'imports-85.data',
    header=FALSE,
    col.names = column.names,
    colClasses = column.types,
    na.strings = "?",
    sep = ","
)
imports.85
str(imports.85)
```
```{r}
library(readr)
imports_85 <- read_csv(
  file = 'imports-85.data',
  na = c("?"),
  col_names = column.names,
  col_types = list(
    "symboling" = col_double(),
    "normalized_losses"=col_double(),
    "make"=col_character(),
    "fuel_type"=col_character(),
    "aspiration"=col_character(),
    "num_of_doors"=col_character(),
    "body_style"=col_character(),
    "drive_wheels"=col_character(),
    "engine_location"=col_character(),
    "wheel_base"=col_double(),
    "length"=col_double(),
    "width"=col_double(),
    "height"=col_double(),
    "curb_weight"=col_integer(),
    "engine_type"=col_character(),
    "num_of_cylinders"=col_character(),
    "engine_size"=col_integer(),
    "fuel_system"=col_character(),
    "bore"=col_double(),
    "stroke"=col_double(),
    "compression_ratio"=col_double(),
    "horsepower"=col_integer(),
    "peak_rpm"=col_integer(),
    "city_mpg"=col_integer(),
    "highway_mpg"=col_integer(),
    "price"=col_integer()
  )
)
imports_85
str(imports_85)
```

#Q3 Technical Questions about importing data

1. If you don’t provide a vector of column names, what happens to the column names of the imported data when you simply invoke read.csv('imports-85.data')?

    _**The first row of data will be treated as the column names by default.**_

2. If you don’t provide a vector of column names, what happens to the column names of the imported data when you invoke read.csv('imports-85.data', header = FALSE)?

    _**The column names of the imported data will be "V1", "V2", "V3", and etc.**_

3. When using the reading table functions, if you don’t specify how missing values are codified, what happens to the data type of those columns that contain '?', e.g. price or num_of_doors?

    _**They will be displayed as factors by default.**_
    
4. Say you import imports-85.data in two different ways. In the first option you import the data without specifying the data type of each column. In the second option you do specify the data types. You may wonder whether both options return a data frame of the same memory size. You can actually use the function object.size() that provides an estimate of the memory that is being used to store an R object. Why is the data frame imported in the second option bigger (in terms of bytes) than the data frame imported in the first option?

    _**Because without specifying the data type, all data are treated as numbers by default, while with specifying the data type, some of them are stored as characters. Number only takes up 8 bytes (1 letter), but character takes up more than 8 bytes.**_

5. Say the object dat is the data frame produced when importing imports-85.data. What happens to the data values if you convert dat as an R matrix?

    _**The date types cannot be perseved when dat is inverted as an R matrix, because in R matrix, every data value should have the same data type, while in data frame data values can have different data types.**_

#Q4 Practice base plotting
```{r}
hist(imports.85$price,  col=c('red','orange','yellow','green','blue','purple','pink','grey','black'), main="Histogram of Price for imports-85.data", xlab= "Price")
```

_**Description: the shape is skewed right (peak at 0-10000); it's not uniform; the mean (balance point) is around 10500; the median is around 10250; the range is from 0-50000 while one standard deviation is around 8000.**_

```{r}
boxplot(imports.85$horsepower,horizontal=TRUE, col = 'pink', main = "Boxplot of Horsepower", xlab = "horsepower")
```

_**Description: the median (which is showed by the bold vertical line in the box) is around 98; the lower quartile (<=25%, which falls on the left side of box) is roughly smaller than 70; the upper quartile (>=75%, which falls on the right side of box) is roughly greater than 115.**_

```{r}
barplot(sort(table(imports.85$body_style),decreasing=TRUE), col = 'pink', main = "Barplot of the Frequencies of Body Style", xlab = "Body-style", ylab = "Frequency")
```

_**Description: the barplot is in the decreasing order from left to right. Sedan has the highest frequency, which is over 80. Convertible has the lowest frequency, which is less than 10. The order of frequency is sedan > hatchback > wagon > hardtop > convertivle.**_

```{r}
stars(imports.85[imports.85$aspiration=='turbo',c('wheel_base','length','width','height','price')], main = "Starsplot of Vehicles with Turbo Aspiration")
```

_**Description: Each start represents one vehicle with turbo aspiration; each spoke in the star represents one variable (since we have five variables, there are five spokes in each star). The data length of a spoke is proportional to the magniude of the variable for the data point relative to the maximum magnitude of the variable across all data points.**_

_**Based on this starsplot, we can see that vehicles like 71, the spokes of which are relative long, should have relative large sizes of variables compared to other vehicles', while the vehicles like 24, the spokes of which are relative small, should have relative small sizes of variables. The length of spokes of some vehicles, like N0.69, are roughly same, showing all of its variables have relative same size compared to other vehicles', while the length of spokes of some vehicles, like 188, are unevenly distributed, showing some of the variables of that vehicle have relative large size but others have relative small size.**_ 

#Q5 Summaries
```{r}
mean(na.omit(imports.85$price[imports.85$fuel_type=='gas']))
mean(na.omit(imports.85$price[imports.85$fuel_type=='diesel']))
```
```{r}
imports.85$make[imports.85$num_of_cylinders=='twelve']
which.max(table(imports.85$make[imports.85$fuel_type=='diesel']))
```
```{r}
max(na.omit(imports.85$horsepower))
imports.85$price[max(na.omit(imports.85$horsepower))] #the price of the largest amount of horsepower is NA
```
```{r}
df_im.85 <- data.frame(imports.85[-c(1:21,23:25)])
df_im.85
na_omit_df_im.85 <- na.omit(df_im.85)
na_omit_df_im.85
na_omit_df_im.85$price[which.max(na_omit_df_im.85$horsepower)] #the price of the second largest amount of horsepower
```
```{r}
quantile(imports.85$city_mpg,c(.1))
quantile(imports.85$highway_mpg,c(.90))
```
```{r}
median(na.omit(imports.85$price[imports.85$city_mpg<=quantile(imports.85$city_mpg,c(.1))]))
```

#Q6 Technical questions about data frames

1. What happens when you use the dollar $ operator on a data frame, attempting to use the name of a column that does not exist? For example: dat$xyz where there is no column named xyz.

    _**The output is NULL.**_
    
2. Which of the following commands fails to return the vector mpg which is a column in the built-in data frame mtcars:

    mtcars$mpg
    
    mtcars[ ,1]
    
    mtcars[[1]]
    
    mtcars[ ,mpg]
    
    mtcars[["mpg"]]
    
    mtcars$"mpg"
    
    mtcars[ ,"mpg"]

    _**mtcars[,mpg] won't work.**_
    
3. Based on your answer for part (b), what is the reason that makes such command to fail?

    _**Because column name is a string, we need "" double quote around it.**_

4. Can you include an R list as a “column” of a data frame? YES or NO, and why.

    _**Yes, because data frame itself is a special type of list.**_

5. What happens when you apply as.list() to a data frame? e.g. as.list(mtcars)

    _**After applying as.list() to a data frame, the type of variable won't change, but it's no longer a data frame.**_
    
```{r}
#test
as.list(mtcars)
typeof(as.list(mtcars)$mpg)
typeof(mtcars$mpg)
str(as.list(mtcars))
str(mtcars)
```

6. Consider the command: abc <- as.list(mtcars). What function(s) can you use to convert the object abc into a data frame?

    _**We can use df <- as.data.frame(abc) to convert it.**_

#Q7 Correlations of quantitative variables
```{r}
qdat <- na.omit(imports.85[,c(10:14,17,19:26)])
qdat
qdat_cor <- cor(qdat)
qdat_cor
```
```{r}
library(corrplot)
corrplot(qdat_cor,method="color", order="hclust",tl.col="black")
```
```{r}
corrplot(qdat_cor,type="upper",order="hclust",tl.col="black",tl.srt=45)
```

_**Description:**_ 

_**The pattern of the square plot is symmetry by the downward 45 line. The darker the color is, the stronger relation the two variables have; the lighter the color is, the weeker relation the two variables have. Each variable has the strongest positive correlation (=1) with itself.**_

_**While the pattern of the sqaure plot showed above is symmetry by the downward 45 line, the triangle plot is only the upper part of the square plot but still able to show the whole relations between pairs of variables. The darker the color is, the bigger the circle is, the stronger relation the two variables have; the lighter the color is, the smaller the circle is, the weeker relation the two variables have.**_

_**According to the size and the color of circles, we can see that "height", "peak-rpm", "compression-ratio" and "stroke" have very week relations with all other variables; "price", "engine-size", "horsepower", "bore", "curb-weight", "length", "width", "wheel-base" have relative strong positive relations with all other variables; "highway-mpg" and "city-mpg" have relative strong negative relations with all other variables. All the variables has the strongest positive linear relation (=1) with itself.**_

#Q8 Principal Components Analysis
```{r}
qdat_prcomp <- prcomp(qdat,scale.=TRUE)
qdat_prcomp
names(qdat_prcomp)
```
```{r}
eigs <- qdat_prcomp$sdev^2
eigs
```
```{r}
eigs_perc <- eigs*100/sum(eigs)
eigs_perc
```
```{r}
eigs_cum <- cumsum(eigs_perc)
eigs_cum
```
```{r}
df_eigs <- data.frame(
  eigenvalue = eigs,
  percentage = eigs_perc,
  'cumulativepercentage' = eigs_cum
)
print(round(df_eigs,4),print.gap=2)
```
```{r}
barplot(eigs[1:3],border=NA,las=1,names.arg=paste('PC',1:3),main='Bar-chart of eigenvalue') 
```
```{r}
plot(qdat_prcomp$x, type = "n", las = 1)
abline(h = 0, v = 0)
points(qdat_prcomp$x[ ,1], 
       qdat_prcomp$x[ ,2],
       pch = 21)
title(main = "scatterplot of vehicles")
```
```{r}
plot(qdat_prcomp$rotation, type = "n", las = 1)
abline(h = 0, v = 0)
points(qdat_prcomp$rotation[ ,1], 
       qdat_prcomp$rotation[ ,2],
       pch = 21)
title(main = "scatterplot of variables")
```
```{r}
biplot(qdat_prcomp,scale=0)
```

_**Description:**_     

_**1. Each point in the scatter plot of the vehicles represents the matrix (or data frame) of prinicple components of each vehicle. From the scatter plot, we can see that the matrices of majority vehicles are located around the center of PC1 and PC2-- they do not spread out too much, even though there are some exceptions.**_
      
_**2. Each point in the scatter plot of the variables represents the loading of each quantitative variable. From the scatter plot, we can see that the majority of loadings of variables are located at the extreme right end of PC1 but spread out in PC2.**_ 
      
